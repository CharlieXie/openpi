# Waypoint Action Expert training config â€” LIBERO
# Usage: torchrun --standalone --nnodes=1 --nproc_per_node=2 scripts/train_waypoint.py --mode ae --config configs/waypoint_ae_libero.yaml

robot_type: libero

# Data paths
original_rlds_dir: /workspace/data/libero/libero_object_no_noops
wp_indices_path: /workspace/data/libero/libero_object_wp_001/waypoint_indices.json
dataset_statistics_path: /workspace/data/libero_object_no_noops/1.0.0

# Model dimensions
model_action_dim: 32
model_proprio_dim: 32
horizon_steps: 32
max_duration: 32
max_token_len: 64

# Model architecture
paligemma_variant: gemma_2b
action_expert_variant: gemma_300m
precision: bfloat16

# Pretrained weights (Pi0.5 base)
pretrained_weight_path: /workspace/models/pi05_base_pytorch

# Training hyperparameters
batch_size: 32
num_train_steps: 30000
warmup_steps: 500
peak_lr: 5.0e-5
end_lr: 1.0e-6

# Normalization
norm_type: q99

# Shuffle
shuffle_buffer_size: 10000

# Logging and checkpointing
exp_name: waypoint_ae_libero
checkpoint_dir: checkpoints/waypoint_ae_libero
save_interval: 2000
log_interval: 50
wandb_enabled: true

# LoRA (set to true for low-memory training)
lora_enabled: false
lora_rank: 16
lora_alpha: 16.0
train_vision_encoder: true

# Resume from checkpoint
resume: false
